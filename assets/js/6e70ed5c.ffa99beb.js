"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[598],{2639:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"guides/relationships","title":"Relationships","description":"Relationships connect entities together, enabling hierarchies, references, and graph structures.","source":"@site/docs/guides/relationships.md","sourceDirName":"guides","slug":"/guides/relationships","permalink":"/AlloyECS/docs/guides/relationships","draft":false,"unlisted":false,"editUrl":"https://github.com/lithh/AlloyECS/edit/main/docs/guides/relationships.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"defaultSidebar","previous":{"title":"Systems","permalink":"/AlloyECS/docs/guides/systems"},"next":{"title":"Prefabs","permalink":"/AlloyECS/docs/guides/prefabs"}}');var l=t(4848),i=t(8453);const a={sidebar_position:4},s="Relationships",o={},d=[{value:"Creating Relationships",id:"creating-relationships",level:2},{value:"Relationship Data",id:"relationship-data",level:2},{value:"Querying Relationships",id:"querying-relationships",level:2},{value:"Check If Relationship Exists",id:"check-if-relationship-exists",level:3},{value:"Get Relationship Data",id:"get-relationship-data",level:3},{value:"Get All Targets",id:"get-all-targets",level:3},{value:"Get All Sources",id:"get-all-sources",level:3},{value:"Removing Relationships",id:"removing-relationships",level:2},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Parent-Child Hierarchy",id:"parent-child-hierarchy",level:3},{value:"Inventory System",id:"inventory-system",level:3},{value:"Targeting System",id:"targeting-system",level:3},{value:"Team/Faction System",id:"teamfaction-system",level:3},{value:"Relationships vs Components",id:"relationships-vs-components",level:2}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"relationships",children:"Relationships"})}),"\n",(0,l.jsx)(n.p,{children:"Relationships connect entities together, enabling hierarchies, references, and graph structures."}),"\n",(0,l.jsx)(n.h2,{id:"creating-relationships",children:"Creating Relationships"}),"\n",(0,l.jsx)(n.p,{children:"First, create a relation type (it's just a component):"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local ChildOf = world:component()\r\nlocal Owns = world:component()\r\nlocal Likes = world:component()\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Then use ",(0,l.jsx)(n.code,{children:"world:relate()"})," to connect entities:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"-- Create a parent-child relationship\r\nlocal parent = world:entity()\r\nlocal child = world:entity()\r\n\r\nworld:relate(child, ChildOf, parent)\n"})}),"\n",(0,l.jsx)(n.h2,{id:"relationship-data",children:"Relationship Data"}),"\n",(0,l.jsx)(n.p,{children:"Relationships can optionally store data:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local Likes = world:component()\r\n\r\n-- Relationship without data\r\nworld:relate(player, Likes, pizza)\r\n\r\n-- Relationship with data\r\nworld:relate(player, Likes, pizza, { amount = 100 })\n"})}),"\n",(0,l.jsx)(n.h2,{id:"querying-relationships",children:"Querying Relationships"}),"\n",(0,l.jsx)(n.h3,{id:"check-if-relationship-exists",children:"Check If Relationship Exists"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'if world:hasRelation(child, ChildOf, parent) then\r\n    print("Is a child of parent")\r\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"get-relationship-data",children:"Get Relationship Data"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local likeData = world:getRelation(player, Likes, item)\r\nif likeData then\r\n    print("Like amount:", likeData.amount)\r\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"get-all-targets",children:"Get All Targets"}),"\n",(0,l.jsx)(n.p,{children:"Find all entities that a source relates to:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Get everything this player likes\r\nlocal likedItems = world:getTargets(player, Likes)\r\n\r\nfor _, item in likedItems do\r\n    print("Player likes:", item)\r\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"get-all-sources",children:"Get All Sources"}),"\n",(0,l.jsx)(n.p,{children:"Find all entities that relate to a target:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Get all children of this parent\r\nlocal children = world:getSources(ChildOf, parent)\r\n\r\nfor _, child in children do\r\n    print("Child:", child)\r\nend\n'})}),"\n",(0,l.jsx)(n.h2,{id:"removing-relationships",children:"Removing Relationships"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"world:unrelate(child, ChildOf, parent)\n"})}),"\n",(0,l.jsx)(n.admonition,{title:"Automatic Cleanup",type:"note",children:(0,l.jsx)(n.p,{children:"When an entity is destroyed, all its relationships (both as source and target) are automatically removed."})}),"\n",(0,l.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,l.jsx)(n.h3,{id:"parent-child-hierarchy",children:"Parent-Child Hierarchy"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local ChildOf = world:component()\r\n\r\nlocal root = world:entity()\r\nlocal branch = world:entity()\r\nlocal leaf = world:entity()\r\n\r\nworld:relate(branch, ChildOf, root)\r\nworld:relate(leaf, ChildOf, branch)\r\n\r\n-- Get children\r\nlocal function getChildren(parent)\r\n    return world:getSources(ChildOf, parent)\r\nend\r\n\r\n-- Get parent\r\nlocal function getParent(child)\r\n    local parents = world:getTargets(child, ChildOf)\r\n    return parents[1]  -- Assuming single parent\r\nend\n"})}),"\n",(0,l.jsx)(n.h3,{id:"inventory-system",children:"Inventory System"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local InInventory = world:component()\r\n\r\nlocal player = world:entity()\r\nlocal sword = world:entity()\r\nlocal potion = world:entity()\r\n\r\n-- Add items to inventory\r\nworld:relate(sword, InInventory, player, { slot = 1 })\r\nworld:relate(potion, InInventory, player, { slot = 2 })\r\n\r\n-- Get all items in player\'s inventory\r\nlocal items = world:getSources(InInventory, player)\r\n\r\n-- Check what slot an item is in\r\nlocal slotData = world:getRelation(sword, InInventory, player)\r\nprint("Sword is in slot:", slotData.slot)\n'})}),"\n",(0,l.jsx)(n.h3,{id:"targeting-system",children:"Targeting System"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local Targeting = world:component()\r\n\r\n-- Entity A targets Entity B\r\nworld:relate(entityA, Targeting, entityB)\r\n\r\n-- Get what this entity is targeting\r\nlocal function getTarget(entity)\r\n    local targets = world:getTargets(entity, Targeting)\r\n    return targets[1]\r\nend\r\n\r\n-- Get all entities targeting this entity\r\nlocal function getTargetedBy(entity)\r\n    return world:getSources(Targeting, entity)\r\nend\n"})}),"\n",(0,l.jsx)(n.h3,{id:"teamfaction-system",children:"Team/Faction System"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local MemberOf = world:component()\r\n\r\nlocal redTeam = world:entity()\r\nlocal blueTeam = world:entity()\r\n\r\n-- Assign players to teams\r\nworld:relate(player1, MemberOf, redTeam)\r\nworld:relate(player2, MemberOf, blueTeam)\r\n\r\n-- Get all members of a team\r\nlocal function getTeamMembers(team)\r\n    return world:getSources(MemberOf, team)\r\nend\r\n\r\n-- Check if two entities are on the same team\r\nlocal function isSameTeam(entityA, entityB)\r\n    local teamA = world:getTargets(entityA, MemberOf)\r\n    local teamB = world:getTargets(entityB, MemberOf)\r\n    return teamA[1] == teamB[1]\r\nend\n"})}),"\n",(0,l.jsx)(n.h2,{id:"relationships-vs-components",children:"Relationships vs Components"}),"\n",(0,l.jsx)(n.p,{children:"When to use each:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Use Case"}),(0,l.jsx)(n.th,{children:"Relationships"}),(0,l.jsx)(n.th,{children:"Components"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Connect two entities"}),(0,l.jsx)(n.td,{children:"\u2705"}),(0,l.jsx)(n.td,{children:"\u274c"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Store entity reference"}),(0,l.jsx)(n.td,{children:"\u2705"}),(0,l.jsx)(n.td,{children:"Can work"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"One-to-many"}),(0,l.jsx)(n.td,{children:"\u2705"}),(0,l.jsx)(n.td,{children:"\u274c"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Many-to-many"}),(0,l.jsx)(n.td,{children:"\u2705"}),(0,l.jsx)(n.td,{children:"\u274c"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Simple data on entity"}),(0,l.jsx)(n.td,{children:"\u274c"}),(0,l.jsx)(n.td,{children:"\u2705"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Queryable in loops"}),(0,l.jsx)(n.td,{children:"\u274c"}),(0,l.jsx)(n.td,{children:"\u2705"})]})]})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"-- \u2705 Use relationship - connecting entities\r\nworld:relate(child, ChildOf, parent)\r\n\r\n-- \u2705 Use component - simple data\r\nworld:set(entity, Health, 100)\r\n\r\n-- \ud83e\udd14 Could use either - entity reference\r\nworld:relate(projectile, FiredBy, player)  -- Relationship\r\nworld:set(projectile, Owner, player)       -- Component (simpler)\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var r=t(6540);const l={},i=r.createContext(l);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);