{"searchDocs":[{"title":"AlloyECS","type":0,"sectionRef":"#","url":"/AlloyECS/docs/intro","content":"","keywords":"","version":"Next"},{"title":"Features‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/docs/intro#features","content":" ‚ö° High performance with bitset queries and cachingüè∑Ô∏è Tag components for zero-cost markersüîó Entity relationshipsüì¶ Prefab system for templatesüéØ System scheduler with phasesüîÑ Change tracking (added/removed/changed)üíæ Serialization support  ","version":"Next","tagName":"h2"},{"title":"Example‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/docs/intro#example","content":" local AlloyECS = require(path.to.AlloyECS) local world = AlloyECS.createWorld() local Position = world:component() local Velocity = world:component() local entity = world:entity() world:set(entity, Position, Vector3.zero) world:set(entity, Velocity, Vector3.new(1, 0, 0)) for id, pos, vel in world:query(Position, Velocity) do world:set(id, Position, pos + vel) end  ","version":"Next","tagName":"h2"},{"title":"AlloyECS","type":0,"sectionRef":"#","url":"/AlloyECS/api/AlloyECS","content":"","keywords":"","version":null},{"title":"Types‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#types","content":" ","version":null,"tagName":"h2"},{"title":"SerializedWorld‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#SerializedWorld","content":"&lt;/&gt; interface SerializedWorld { entities:¬†{{ id:¬†number, components:¬†{{ componentId:¬†number, value:¬†any }} }}-- Array of serialized entities relationships:¬†{{ source:¬†number, relation:¬†number, target:¬†number, value:¬†any? }}-- Array of serialized relationships } Represents a serialized world state that can be saved and restored.  ","version":null,"tagName":"h3"},{"title":"QueryBuilder‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#QueryBuilder","content":"&lt;/&gt; interface QueryBuilder { with:¬†(...number)¬†‚Üí¬†QueryBuilder-- Add required components (entities must have these but values won't be returned) without:¬†(...number)¬†‚Üí¬†QueryBuilder-- Exclude entities with these components iter:¬†()¬†‚Üí¬†QueryIterator-- Execute the query and return an iterator } A builder for constructing complex queries with filters. Simple Queries For most queries, use World:query directly. The builder pattern is only needed when you need :with() or :without() filters. -- Simple query (preferred for most cases) for entityId, pos, vel in world:query(Position, Velocity) do -- ... end -- Complex query with filters for entityId, pos in world:query(Position):with(Player):without(Dead):iter() do -- Process living players with positions end   ","version":null,"tagName":"h3"},{"title":"PrefabBuilder‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#PrefabBuilder","content":"&lt;/&gt; interface PrefabBuilder { with:¬†( componentId:¬†number, value:¬†any? )¬†‚Üí¬†PrefabBuilder-- Add a component or tag to the prefab build:¬†(name:¬†string?)¬†‚Üí¬†PrefabData-- Build the prefab, optionally registering it by name } A builder for constructing entity prefabs (templates). local enemyPrefab = world:prefab() :with(Health, 100) :with(Position, Vector3.zero) :with(Enemy) :build(&quot;Enemy&quot;) local enemy = world:spawn(&quot;Enemy&quot;)   ","version":null,"tagName":"h3"},{"title":"WorldConfig‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#WorldConfig","content":"&lt;/&gt; interface WorldConfig { trackChanges:¬†boolean?-- Enable change tracking for added/removed/changed queries debug:¬†boolean?-- Enable debug warnings for invalid operations } Configuration options for creating a new world. ","version":null,"tagName":"h3"},{"title":"Properties‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#properties","content":" ","version":null,"tagName":"h2"},{"title":"MAX_ENTITY_INDEX‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#MAX_ENTITY_INDEX","content":"&lt;/&gt; AlloyECS.MAX_ENTITY_INDEX: number The maximum entity index value (16,777,215 with 24-bit indices).  ","version":null,"tagName":"h3"},{"title":"MAX_GENERATION‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#MAX_GENERATION","content":"&lt;/&gt; AlloyECS.MAX_GENERATION: number The maximum generation value (255 with 8-bit generations).  ","version":null,"tagName":"h3"},{"title":"Bitset‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#Bitset","content":"&lt;/&gt; AlloyECS.Bitset: Bitset The Bitset module for low-level bitset operations.  ","version":null,"tagName":"h3"},{"title":"CommandBuffer‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#CommandBuffer","content":"&lt;/&gt; AlloyECS.CommandBuffer: CommandBuffer The CommandBuffer module for deferred operations.  ","version":null,"tagName":"h3"},{"title":"Reactive‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#Reactive","content":"&lt;/&gt; AlloyECS.Reactive: Reactive The Reactive module for change tracking.  ","version":null,"tagName":"h3"},{"title":"Scheduler‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#Scheduler","content":"&lt;/&gt; AlloyECS.Scheduler: Scheduler The Scheduler module for system scheduling. ","version":null,"tagName":"h3"},{"title":"Functions‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#functions","content":" ","version":null,"tagName":"h2"},{"title":"encodeEntityId‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#encodeEntityId","content":"&lt;/&gt; AlloyECS.encodeEntityId( index:¬†number,-- The entity index (0 to MAX_ENTITY_INDEX) generation:¬†number-- The generation counter (0 to MAX_GENERATION) ) ‚Üí¬†number-- The encoded entity ID Encodes an entity index and generation into a single entity ID. Entity IDs use 24 bits for index and 8 bits for generation.  ","version":null,"tagName":"h3"},{"title":"decodeEntityIndex‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#decodeEntityIndex","content":"&lt;/&gt; AlloyECS.decodeEntityIndex( entityId:¬†number-- The entity ID to decode ) ‚Üí¬†number-- The entity index portion Extracts the index portion from an encoded entity ID.  ","version":null,"tagName":"h3"},{"title":"decodeEntityGeneration‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#decodeEntityGeneration","content":"&lt;/&gt; AlloyECS.decodeEntityGeneration( entityId:¬†number-- The entity ID to decode ) ‚Üí¬†number-- The generation portion Extracts the generation portion from an encoded entity ID. Useful for checking if an entity ID is stale.  ","version":null,"tagName":"h3"},{"title":"createWorld‚Äã","type":1,"pageTitle":"AlloyECS","url":"/AlloyECS/api/AlloyECS#createWorld","content":"&lt;/&gt; AlloyECS.createWorld( config:¬†WorldConfig?-- Optional configuration ) ‚Üí¬†World-- The new world instance Creates a new ECS world. -- Basic world local world = AlloyECS.createWorld() -- With change tracking enabled local world = AlloyECS.createWorld({ trackChanges = true, debug = true, })  ","version":null,"tagName":"h3"},{"title":"Getting Started","type":0,"sectionRef":"#","url":"/AlloyECS/docs/getting-started","content":"","keywords":"","version":"Next"},{"title":"Creating a World‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#creating-a-world","content":" The World is the container for all ECS data. Start by creating one:  local AlloyECS = require(path.to.AlloyECS) local world = AlloyECS.createWorld()   ","version":"Next","tagName":"h2"},{"title":"World Configuration‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#world-configuration","content":" You can enable optional features:  local world = AlloyECS.createWorld({ trackChanges = true, -- Enable reactive queries (added/removed/changed) debug = true, -- Enable debug warnings })   ","version":"Next","tagName":"h3"},{"title":"Defining Components‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#defining-components","content":" Components are data containers. Create them using world:component():  -- Components with data local Position = world:component() local Health = world:component() local Name = world:component() -- Tags (no data, just markers) local Player = world:tag() local Enemy = world:tag()   Component Storage For components that will be on most entities, consider using dense storage: local Transform = world:component({ storage = &quot;dense&quot; })   ","version":"Next","tagName":"h2"},{"title":"Creating Entities‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#creating-entities","content":" Entities are just numbers. Create them with world:entity():  local player = world:entity() local enemy = world:entity()   ","version":"Next","tagName":"h2"},{"title":"Adding Components to Entities‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#adding-components-to-entities","content":" Use set for components with data, add for tags:  -- Set component data world:set(player, Position, Vector3.new(0, 5, 0)) world:set(player, Health, 100) world:set(player, Name, &quot;Hero&quot;) -- Add tags world:add(player, Player)   ","version":"Next","tagName":"h2"},{"title":"Querying Entities‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#querying-entities","content":" Find entities with specific components:  -- Simple query for entityId, pos in world:query(Position) do print(entityId, &quot;is at&quot;, pos) end -- Multiple components for entityId, pos, health in world:query(Position, Health) do print(entityId, &quot;at&quot;, pos, &quot;with&quot;, health, &quot;HP&quot;) end -- With filters for entityId, pos in world:query(Position):with(Player):without(Enemy):iter() do -- Only players with Position, not enemies end   ","version":"Next","tagName":"h2"},{"title":"Reading and Modifying Components‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#reading-and-modifying-components","content":" -- Read a component local pos = world:get(entity, Position) -- Check if entity has component if world:has(entity, Position) then -- ... end -- Remove a component world:remove(entity, Velocity) -- Destroy an entity entirely world:destroy(entity)   ","version":"Next","tagName":"h2"},{"title":"Game Loop Integration‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#game-loop-integration","content":" Use step() to run all systems and handle cleanup:  local RunService = game:GetService(&quot;RunService&quot;) RunService.Heartbeat:Connect(function(deltaTime) world:step(deltaTime) end)   ","version":"Next","tagName":"h2"},{"title":"Next Steps‚Äã","type":1,"pageTitle":"Getting Started","url":"/AlloyECS/docs/getting-started#next-steps","content":" Now that you know the basics, check out:  Components Guide - Storage types, tags, and best practicesQueries Guide - Advanced querying techniquesSystems Guide - Organizing game logic ","version":"Next","tagName":"h2"},{"title":"Queries","type":0,"sectionRef":"#","url":"/AlloyECS/docs/guides/queries","content":"","keywords":"","version":"Next"},{"title":"Basic Queries‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#basic-queries","content":" Query for entities with specific components:  -- Single component for entityId, position in world:query(Position) do print(entityId, position) end -- Multiple components for entityId, pos, vel in world:query(Position, Velocity) do world:set(entityId, Position, pos + vel * deltaTime) end -- Three components for entityId, pos, vel, health in world:query(Position, Velocity, Health) do -- ... end   ","version":"Next","tagName":"h2"},{"title":"Query Filters‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#query-filters","content":" Use filters to refine your queries:  ","version":"Next","tagName":"h2"},{"title":"With Filter‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#with-filter","content":" Require components without retrieving their values:  -- Entities with Position AND Player tag, but only return Position for entityId, pos in world:query(Position):with(Player):iter() do -- pos is returned -- Player is required but not returned (it's a tag anyway) end   ","version":"Next","tagName":"h3"},{"title":"Without Filter‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#without-filter","content":" Exclude entities with certain components:  -- Entities with Position but NOT Dead for entityId, pos in world:query(Position):without(Dead):iter() do -- Only living entities end   ","version":"Next","tagName":"h3"},{"title":"Combining Filters‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#combining-filters","content":" for entityId, pos, vel in world:query(Position, Velocity) :with(Player) :without(Dead, Stunned) :iter() do -- Players with Position and Velocity -- That are not Dead or Stunned end   Remember iter() When using :with() or :without(), you must call :iter() at the end! -- ‚úÖ Correct for e, p in world:query(Position):with(Player):iter() do end -- ‚ùå Wrong - missing iter() for e, p in world:query(Position):with(Player) do end   ","version":"Next","tagName":"h3"},{"title":"Query Caching‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#query-caching","content":" Queries are automatically cached for performance. When you run the same query multiple times, AlloyECS reuses the cached results.  -- First call - builds and caches results for entityId, pos in world:query(Position) do end -- Subsequent calls - uses cache (very fast!) for entityId, pos in world:query(Position) do end for entityId, pos in world:query(Position) do end   The cache is automatically invalidated when:  Entities are created or destroyedComponents are added or removed  ","version":"Next","tagName":"h2"},{"title":"Reactive Queries‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#reactive-queries","content":" With trackChanges = true, you can query for changes:  local world = AlloyECS.createWorld({ trackChanges = true }) -- Entities that gained Position this frame for _, entityId in world:added(Position) do print(&quot;New position on:&quot;, entityId) end -- Entities that lost Position this frame for _, entityId in world:removed(Position) do print(&quot;Position removed from:&quot;, entityId) end -- Entities whose Position changed this frame for _, entityId in world:changed(Position) do print(&quot;Position changed on:&quot;, entityId) end   Clear Changes Call world:clearChanges() at the end of each frame, or use world:step() which does this automatically.  ","version":"Next","tagName":"h2"},{"title":"Query Performance Tips‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#query-performance-tips","content":" ","version":"Next","tagName":"h2"},{"title":"1. Query Order Matters‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#1-query-order-matters","content":" Put the rarest component first for better performance:  -- ‚úÖ Better - Boss is rare for e, pos in world:query(Boss, Position) do end -- ‚ùå Slower - Position is common for e, pos in world:query(Position, Boss) do end   ","version":"Next","tagName":"h3"},{"title":"2. Use With for Tags‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#2-use-with-for-tags","content":" When you don't need the value, use :with():  -- ‚úÖ Better - Player value not unpacked for e, pos in world:query(Position):with(Player):iter() do end -- ‚ùå Slower - Player value unpacked but unused for e, pos, _ in world:query(Position, Player) do end   ","version":"Next","tagName":"h3"},{"title":"3. Cache Query Components‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#3-cache-query-components","content":" Don't rebuild component lists each frame:  -- ‚úÖ Good - components defined once local Position, Velocity = world:component(), world:component() RunService.Heartbeat:Connect(function(dt) for e, pos, vel in world:query(Position, Velocity) do world:set(e, Position, pos + vel * dt) end end)   ","version":"Next","tagName":"h3"},{"title":"4. Avoid Modifying During Iteration‚Äã","type":1,"pageTitle":"Queries","url":"/AlloyECS/docs/guides/queries#4-avoid-modifying-during-iteration","content":" Use deferred operations when modifying entities during queries:  -- ‚úÖ Safe - deferred destruction for entityId, health in world:query(Health) do if health &lt;= 0 then world:deferDestroy(entityId) end end world:flush() -- ‚ùå Dangerous - modifying during iteration for entityId, health in world:query(Health) do if health &lt;= 0 then world:destroy(entityId) -- May cause issues! end end  ","version":"Next","tagName":"h3"},{"title":"Systems","type":0,"sectionRef":"#","url":"/AlloyECS/docs/guides/systems","content":"","keywords":"","version":"Next"},{"title":"Creating Systems‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#creating-systems","content":" Add systems with world:addSystem():  world:addSystem( &quot;Movement&quot;, -- Unique name &quot;Update&quot;, -- Phase { -- Dependencies reads = { Position, Velocity }, writes = { Position } }, function(deltaTime) -- Callback for entityId, pos, vel in world:query(Position, Velocity) do world:set(entityId, Position, pos + vel * deltaTime) end end )   ","version":"Next","tagName":"h2"},{"title":"System Phases‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#system-phases","content":" Systems run in phases, executed in order:  Phase\tOrder\tTypical UsePreUpdate\t1st\tInput processing, physics preparation Update\t2nd\tMain game logic PostUpdate\t3rd\tCleanup, collision response PreRender\t4th\tVisual preparation Render\t5th\tRendering, UI updates  -- Input runs first world:addSystem(&quot;Input&quot;, &quot;PreUpdate&quot;, {}, function(dt) -- Process player input end) -- Movement runs during update world:addSystem(&quot;Movement&quot;, &quot;Update&quot;, { writes = { Position } }, function(dt) -- Move entities end) -- Cleanup runs after world:addSystem(&quot;DeathCleanup&quot;, &quot;PostUpdate&quot;, {}, function(dt) for entityId in world:query(Dead) do world:destroy(entityId) end end)   ","version":"Next","tagName":"h2"},{"title":"Running Systems‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#running-systems","content":" ","version":"Next","tagName":"h2"},{"title":"Run All Systems‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#run-all-systems","content":" world:runSystems(deltaTime)   ","version":"Next","tagName":"h3"},{"title":"Run Specific Phase‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#run-specific-phase","content":" world:runPhase(&quot;Update&quot;, deltaTime)   ","version":"Next","tagName":"h3"},{"title":"Using Step (Recommended)‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#using-step-recommended","content":" step() handles everything:  RunService.Heartbeat:Connect(function(dt) world:step(dt) -- Flushes commands, runs systems, clears changes end)   ","version":"Next","tagName":"h3"},{"title":"Managing Systems‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#managing-systems","content":" ","version":"Next","tagName":"h2"},{"title":"Enable/Disable‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#enabledisable","content":" -- Disable a system (doesn't remove it) world:disableSystem(&quot;AI&quot;) -- Re-enable it world:enableSystem(&quot;AI&quot;)   ","version":"Next","tagName":"h3"},{"title":"Remove‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#remove","content":" world:removeSystem(&quot;Movement&quot;)   ","version":"Next","tagName":"h3"},{"title":"System Dependencies‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#system-dependencies","content":" Declare what components a system reads and writes:  world:addSystem(&quot;Movement&quot;, &quot;Update&quot;, { reads = { Position, Velocity }, writes = { Position } }, function(dt) -- ... end)   This helps with:  DocumentationFuture parallelizationDebugging  ","version":"Next","tagName":"h2"},{"title":"Practical Example‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#practical-example","content":" Here's a complete game loop with multiple systems:  local AlloyECS = require(path.to.AlloyECS) local RunService = game:GetService(&quot;RunService&quot;) -- Create world local world = AlloyECS.createWorld({ trackChanges = true }) -- Components local Position = world:component() local Velocity = world:component() local Health = world:component() local Dead = world:tag() local Player = world:tag() -- Input System world:addSystem(&quot;Input&quot;, &quot;PreUpdate&quot;, { writes = { Velocity } }, function(dt) for entityId, vel in world:query(Velocity):with(Player):iter() do -- Read input and update velocity local input = Vector3.new(0, 0, 0) -- ... get input ... world:set(entityId, Velocity, input * 50) end end) -- Movement System world:addSystem(&quot;Movement&quot;, &quot;Update&quot;, { reads = { Velocity }, writes = { Position } }, function(dt) for entityId, pos, vel in world:query(Position, Velocity) do world:set(entityId, Position, pos + vel * dt) end end) -- Death System world:addSystem(&quot;Death&quot;, &quot;Update&quot;, { reads = { Health }, writes = { Dead } }, function(dt) for entityId, health in world:query(Health):without(Dead):iter() do if health &lt;= 0 then world:add(entityId, Dead) end end end) -- Cleanup System world:addSystem(&quot;Cleanup&quot;, &quot;PostUpdate&quot;, { reads = { Dead } }, function(dt) for entityId in world:query(Dead) do world:deferDestroy(entityId) end end) -- Game Loop RunService.Heartbeat:Connect(function(dt) world:step(dt) end)   ","version":"Next","tagName":"h2"},{"title":"Tips‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#tips","content":" ","version":"Next","tagName":"h2"},{"title":"1. Keep Systems Focused‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#1-keep-systems-focused","content":" Each system should do one thing well:  -- ‚úÖ Good - focused systems world:addSystem(&quot;Movement&quot;, ...) world:addSystem(&quot;Collision&quot;, ...) world:addSystem(&quot;Damage&quot;, ...) -- ‚ùå Avoid - monolithic system world:addSystem(&quot;Everything&quot;, ..., function(dt) -- 500 lines of code end)   ","version":"Next","tagName":"h3"},{"title":"2. Use Phases Correctly‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#2-use-phases-correctly","content":" Don't put everything in &quot;Update&quot;:  -- ‚úÖ Good - proper phase usage world:addSystem(&quot;Input&quot;, &quot;PreUpdate&quot;, ...) world:addSystem(&quot;Physics&quot;, &quot;Update&quot;, ...) world:addSystem(&quot;Render&quot;, &quot;Render&quot;, ...)   ","version":"Next","tagName":"h3"},{"title":"3. Disable When Not Needed‚Äã","type":1,"pageTitle":"Systems","url":"/AlloyECS/docs/guides/systems#3-disable-when-not-needed","content":" -- Disable AI during cutscenes local function startCutscene() world:disableSystem(&quot;AI&quot;) world:disableSystem(&quot;PlayerInput&quot;) end local function endCutscene() world:enableSystem(&quot;AI&quot;) world:enableSystem(&quot;PlayerInput&quot;) end  ","version":"Next","tagName":"h3"},{"title":"Components","type":0,"sectionRef":"#","url":"/AlloyECS/docs/guides/components","content":"","keywords":"","version":"Next"},{"title":"Creating Components‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#creating-components","content":" local Position = world:component() local Velocity = world:component() local Health = world:component()   Each call to component() returns a unique component ID (a number).  ","version":"Next","tagName":"h2"},{"title":"Storage Types‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#storage-types","content":" AlloyECS supports different storage types optimized for different use cases:  Type\tDescription\tBest Forsparse\tDefault, hash-map based\tMost components dense\t(Coming soon) Array-based\tComponents on 50%+ of entities tag\tNo data storage\tBoolean flags  -- Sparse (default) local Position = world:component() local Position = world:component({ storage = &quot;sparse&quot; }) -- Tag - no data, just presence local Visible = world:component({ storage = &quot;tag&quot; })   Dense Storage Dense storage is planned for a future release. For now, use sparse (the default).  ","version":"Next","tagName":"h2"},{"title":"Tags‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#tags","content":" Tags are components without data. Use them to mark or categorize entities:  -- Create a tag (shorthand for storage = &quot;tag&quot;) local Player = world:tag() local Enemy = world:tag() local Dead = world:tag() -- Add to entity world:add(entity, Player) -- Check presence if world:has(entity, Player) then -- This is a player end -- Tags return nil from get() local value = world:get(entity, Player) -- nil -- Use has() instead local isPlayer = world:has(entity, Player) -- true/false   ","version":"Next","tagName":"h2"},{"title":"Setting Component Data‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#setting-component-data","content":" -- Set a component value world:set(entity, Position, Vector3.new(0, 10, 0)) world:set(entity, Health, 100) -- Setting adds the component if not present -- Setting updates the value if already present   ","version":"Next","tagName":"h2"},{"title":"Getting Component Data‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#getting-component-data","content":" local pos = world:get(entity, Position) if pos then print(&quot;Position:&quot;, pos.X, pos.Y, pos.Z) end   ","version":"Next","tagName":"h2"},{"title":"Checking Components‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#checking-components","content":" -- Check single component if world:has(entity, Position) then -- Entity has Position end -- Check multiple components if world:has(entity, Position, Velocity) then -- Entity has both Position AND Velocity end   ","version":"Next","tagName":"h2"},{"title":"Removing Components‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#removing-components","content":" world:remove(entity, Velocity)   ","version":"Next","tagName":"h2"},{"title":"Component Hooks‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#component-hooks","content":" React to component changes with hooks:  -- When component is added world:onAdd(Position, function(entityId, value) print(&quot;Entity&quot;, entityId, &quot;gained Position:&quot;, value) end) -- When component is removed world:onRemove(Health, function(entityId, oldValue) if oldValue &lt;= 0 then print(&quot;Entity&quot;, entityId, &quot;died!&quot;) end end) -- When component value changes world:onChange(Position, function(entityId, oldPos, newPos) print(&quot;Entity&quot;, entityId, &quot;moved from&quot;, oldPos, &quot;to&quot;, newPos) end)   ","version":"Next","tagName":"h2"},{"title":"Unsubscribing‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#unsubscribing","content":" Hooks return an unsubscribe function:  local unsubscribe = world:onAdd(Position, function(entityId, value) -- ... end) -- Later, stop listening unsubscribe()   ","version":"Next","tagName":"h3"},{"title":"Best Practices‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#best-practices","content":" ","version":"Next","tagName":"h2"},{"title":"1. Keep Components Small‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#1-keep-components-small","content":" -- ‚úÖ Good - small, focused components local Position = world:component() -- Vector3 local Velocity = world:component() -- Vector3 local Health = world:component() -- number -- ‚ùå Avoid - large monolithic components local PlayerData = world:component() -- { pos, vel, health, mana, inventory, ... }   ","version":"Next","tagName":"h3"},{"title":"2. Use Tags for Flags‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#2-use-tags-for-flags","content":" -- ‚úÖ Good - tags for boolean state local Dead = world:tag() local Stunned = world:tag() -- ‚ùå Avoid - components with boolean values local IsDead = world:component() world:set(entity, IsDead, true)   ","version":"Next","tagName":"h3"},{"title":"3. Define Components Once‚Äã","type":1,"pageTitle":"Components","url":"/AlloyECS/docs/guides/components#3-define-components-once","content":" -- ‚úÖ Good - define at module level local Position = world:component() local Velocity = world:component() -- ‚ùå Avoid - creating in loops or functions for i = 1, 100 do local Position = world:component() -- Creates 100 different components! end  ","version":"Next","tagName":"h3"},{"title":"Prefabs","type":0,"sectionRef":"#","url":"/AlloyECS/docs/guides/prefabs","content":"","keywords":"","version":"Next"},{"title":"Creating Prefabs‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#creating-prefabs","content":" Use the builder pattern to define a prefab:  local enemyPrefab = world:prefab() :with(Health, 100) :with(Position, Vector3.zero) :with(Damage, 10) :with(Enemy) -- Tag (no value needed) :build()   ","version":"Next","tagName":"h2"},{"title":"Named Prefabs‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#named-prefabs","content":" Register prefabs by name for easy access:  world:prefab() :with(Health, 100) :with(Position, Vector3.zero) :with(Enemy) :build(&quot;BasicEnemy&quot;) world:prefab() :with(Health, 500) :with(Position, Vector3.zero) :with(Damage, 50) :with(Enemy) :with(Boss) :build(&quot;BossEnemy&quot;)   ","version":"Next","tagName":"h3"},{"title":"Spawning from Prefabs‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#spawning-from-prefabs","content":" ","version":"Next","tagName":"h2"},{"title":"From Prefab Object‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#from-prefab-object","content":" local enemy = world:spawn(enemyPrefab)   ","version":"Next","tagName":"h3"},{"title":"From Name‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#from-name","content":" local enemy = world:spawn(&quot;BasicEnemy&quot;) local boss = world:spawn(&quot;BossEnemy&quot;)   ","version":"Next","tagName":"h3"},{"title":"Customizing After Spawn‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#customizing-after-spawn","content":" Prefabs create the entity with default values. Customize afterward:  local enemy = world:spawn(&quot;BasicEnemy&quot;) -- Override position world:set(enemy, Position, Vector3.new(10, 0, 20)) -- Add additional components world:set(enemy, PatrolPath, { ... })   ","version":"Next","tagName":"h2"},{"title":"Retrieving Prefabs‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#retrieving-prefabs","content":" Get a registered prefab by name:  local prefab = world:prefab(&quot;BasicEnemy&quot;)   ","version":"Next","tagName":"h2"},{"title":"Practical Examples‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#practical-examples","content":" ","version":"Next","tagName":"h2"},{"title":"Enemy Types‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#enemy-types","content":" -- Components local Health = world:component() local Damage = world:component() local Speed = world:component() local Position = world:component() local Enemy = world:tag() local Flying = world:tag() local Boss = world:tag() -- Define enemy prefabs world:prefab() :with(Health, 50) :with(Damage, 5) :with(Speed, 10) :with(Position, Vector3.zero) :with(Enemy) :build(&quot;Slime&quot;) world:prefab() :with(Health, 30) :with(Damage, 10) :with(Speed, 20) :with(Position, Vector3.zero) :with(Enemy) :with(Flying) :build(&quot;Bat&quot;) world:prefab() :with(Health, 1000) :with(Damage, 50) :with(Speed, 5) :with(Position, Vector3.zero) :with(Enemy) :with(Boss) :build(&quot;Dragon&quot;) -- Spawn enemies local function spawnEnemy(enemyType, position) local enemy = world:spawn(enemyType) world:set(enemy, Position, position) return enemy end spawnEnemy(&quot;Slime&quot;, Vector3.new(10, 0, 10)) spawnEnemy(&quot;Bat&quot;, Vector3.new(0, 10, 0)) spawnEnemy(&quot;Dragon&quot;, Vector3.new(100, 0, 100))   ","version":"Next","tagName":"h3"},{"title":"Item System‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#item-system","content":" local Name = world:component() local Value = world:component() local Stackable = world:tag() local Consumable = world:tag() local Equipment = world:tag() -- Consumables world:prefab() :with(Name, &quot;Health Potion&quot;) :with(Value, 50) :with(Stackable) :with(Consumable) :build(&quot;HealthPotion&quot;) world:prefab() :with(Name, &quot;Mana Potion&quot;) :with(Value, 30) :with(Stackable) :with(Consumable) :build(&quot;ManaPotion&quot;) -- Equipment world:prefab() :with(Name, &quot;Iron Sword&quot;) :with(Damage, 15) :with(Equipment) :build(&quot;IronSword&quot;)   ","version":"Next","tagName":"h3"},{"title":"Projectiles‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#projectiles","content":" local Velocity = world:component() local Lifetime = world:component() local Projectile = world:tag() world:prefab() :with(Position, Vector3.zero) :with(Velocity, Vector3.zero) :with(Damage, 10) :with(Lifetime, 5) :with(Projectile) :build(&quot;Arrow&quot;) world:prefab() :with(Position, Vector3.zero) :with(Velocity, Vector3.zero) :with(Damage, 30) :with(Lifetime, 3) :with(Projectile) :build(&quot;Fireball&quot;) -- Spawn projectile with direction local function fireProjectile(prefabName, origin, direction, speed) local proj = world:spawn(prefabName) world:set(proj, Position, origin) world:set(proj, Velocity, direction.Unit * speed) return proj end fireProjectile(&quot;Arrow&quot;, playerPos, aimDirection, 100)   ","version":"Next","tagName":"h3"},{"title":"Best Practices‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#best-practices","content":" ","version":"Next","tagName":"h2"},{"title":"1. Use Descriptive Names‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#1-use-descriptive-names","content":" -- ‚úÖ Good world:prefab():with(...):build(&quot;BasicEnemy&quot;) world:prefab():with(...):build(&quot;FireElemental&quot;) -- ‚ùå Avoid world:prefab():with(...):build(&quot;e1&quot;) world:prefab():with(...):build(&quot;enemy&quot;)   ","version":"Next","tagName":"h3"},{"title":"2. Create Prefabs at Startup‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#2-create-prefabs-at-startup","content":" -- ‚úÖ Good - create once at startup local function initPrefabs(world) world:prefab():with(...):build(&quot;Enemy&quot;) world:prefab():with(...):build(&quot;Item&quot;) end -- ‚ùå Avoid - creating during gameplay local function spawnEnemy() world:prefab():with(...):build(&quot;Enemy&quot;) -- Recreates each time! return world:spawn(&quot;Enemy&quot;) end   ","version":"Next","tagName":"h3"},{"title":"3. Keep Prefabs Generic‚Äã","type":1,"pageTitle":"Prefabs","url":"/AlloyECS/docs/guides/prefabs#3-keep-prefabs-generic","content":" Use prefabs for common base values, customize specific instances:  -- ‚úÖ Good - generic prefab, specific customization local enemy = world:spawn(&quot;Enemy&quot;) world:set(enemy, Position, spawnPoint) world:set(enemy, PatrolPath, specificPath) -- ‚ùå Avoid - overly specific prefabs world:prefab() :with(Position, Vector3.new(10, 0, 20)) -- Too specific! :build(&quot;EnemyAtPosition10_0_20&quot;)  ","version":"Next","tagName":"h3"},{"title":"Relationships","type":0,"sectionRef":"#","url":"/AlloyECS/docs/guides/relationships","content":"","keywords":"","version":"Next"},{"title":"Creating Relationships‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#creating-relationships","content":" First, create a relation type (it's just a component):  local ChildOf = world:component() local Owns = world:component() local Likes = world:component()   Then use world:relate() to connect entities:  -- Create a parent-child relationship local parent = world:entity() local child = world:entity() world:relate(child, ChildOf, parent)   ","version":"Next","tagName":"h2"},{"title":"Relationship Data‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#relationship-data","content":" Relationships can optionally store data:  local Likes = world:component() -- Relationship without data world:relate(player, Likes, pizza) -- Relationship with data world:relate(player, Likes, pizza, { amount = 100 })   ","version":"Next","tagName":"h2"},{"title":"Querying Relationships‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#querying-relationships","content":" ","version":"Next","tagName":"h2"},{"title":"Check If Relationship Exists‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#check-if-relationship-exists","content":" if world:hasRelation(child, ChildOf, parent) then print(&quot;Is a child of parent&quot;) end   ","version":"Next","tagName":"h3"},{"title":"Get Relationship Data‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#get-relationship-data","content":" local likeData = world:getRelation(player, Likes, item) if likeData then print(&quot;Like amount:&quot;, likeData.amount) end   ","version":"Next","tagName":"h3"},{"title":"Get All Targets‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#get-all-targets","content":" Find all entities that a source relates to:  -- Get everything this player likes local likedItems = world:getTargets(player, Likes) for _, item in likedItems do print(&quot;Player likes:&quot;, item) end   ","version":"Next","tagName":"h3"},{"title":"Get All Sources‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#get-all-sources","content":" Find all entities that relate to a target:  -- Get all children of this parent local children = world:getSources(ChildOf, parent) for _, child in children do print(&quot;Child:&quot;, child) end   ","version":"Next","tagName":"h3"},{"title":"Removing Relationships‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#removing-relationships","content":" world:unrelate(child, ChildOf, parent)   Automatic Cleanup When an entity is destroyed, all its relationships (both as source and target) are automatically removed.  ","version":"Next","tagName":"h2"},{"title":"Common Patterns‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#common-patterns","content":" ","version":"Next","tagName":"h2"},{"title":"Parent-Child Hierarchy‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#parent-child-hierarchy","content":" local ChildOf = world:component() local root = world:entity() local branch = world:entity() local leaf = world:entity() world:relate(branch, ChildOf, root) world:relate(leaf, ChildOf, branch) -- Get children local function getChildren(parent) return world:getSources(ChildOf, parent) end -- Get parent local function getParent(child) local parents = world:getTargets(child, ChildOf) return parents[1] -- Assuming single parent end   ","version":"Next","tagName":"h3"},{"title":"Inventory System‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#inventory-system","content":" local InInventory = world:component() local player = world:entity() local sword = world:entity() local potion = world:entity() -- Add items to inventory world:relate(sword, InInventory, player, { slot = 1 }) world:relate(potion, InInventory, player, { slot = 2 }) -- Get all items in player's inventory local items = world:getSources(InInventory, player) -- Check what slot an item is in local slotData = world:getRelation(sword, InInventory, player) print(&quot;Sword is in slot:&quot;, slotData.slot)   ","version":"Next","tagName":"h3"},{"title":"Targeting System‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#targeting-system","content":" local Targeting = world:component() -- Entity A targets Entity B world:relate(entityA, Targeting, entityB) -- Get what this entity is targeting local function getTarget(entity) local targets = world:getTargets(entity, Targeting) return targets[1] end -- Get all entities targeting this entity local function getTargetedBy(entity) return world:getSources(Targeting, entity) end   ","version":"Next","tagName":"h3"},{"title":"Team/Faction System‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#teamfaction-system","content":" local MemberOf = world:component() local redTeam = world:entity() local blueTeam = world:entity() -- Assign players to teams world:relate(player1, MemberOf, redTeam) world:relate(player2, MemberOf, blueTeam) -- Get all members of a team local function getTeamMembers(team) return world:getSources(MemberOf, team) end -- Check if two entities are on the same team local function isSameTeam(entityA, entityB) local teamA = world:getTargets(entityA, MemberOf) local teamB = world:getTargets(entityB, MemberOf) return teamA[1] == teamB[1] end   ","version":"Next","tagName":"h3"},{"title":"Relationships vs Components‚Äã","type":1,"pageTitle":"Relationships","url":"/AlloyECS/docs/guides/relationships#relationships-vs-components","content":" When to use each:  Use Case\tRelationships\tComponentsConnect two entities\t‚úÖ\t‚ùå Store entity reference\t‚úÖ\tCan work One-to-many\t‚úÖ\t‚ùå Many-to-many\t‚úÖ\t‚ùå Simple data on entity\t‚ùå\t‚úÖ Queryable in loops\t‚ùå\t‚úÖ  -- ‚úÖ Use relationship - connecting entities world:relate(child, ChildOf, parent) -- ‚úÖ Use component - simple data world:set(entity, Health, 100) -- ü§î Could use either - entity reference world:relate(projectile, FiredBy, player) -- Relationship world:set(projectile, Owner, player) -- Component (simpler)  ","version":"Next","tagName":"h2"},{"title":"Deferred Operations","type":0,"sectionRef":"#","url":"/AlloyECS/docs/guides/deferred-operations","content":"","keywords":"","version":"Next"},{"title":"The Problem‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#the-problem","content":" Modifying entities during iteration can cause issues:  -- ‚ùå Dangerous - modifying during iteration for entityId, health in world:query(Health) do if health &lt;= 0 then world:destroy(entityId) -- Might break iteration! end end   ","version":"Next","tagName":"h2"},{"title":"The Solution‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#the-solution","content":" Queue operations and execute them after iteration:  -- ‚úÖ Safe - deferred operations for entityId, health in world:query(Health) do if health &lt;= 0 then world:deferDestroy(entityId) end end world:flush() -- Execute all queued operations   ","version":"Next","tagName":"h2"},{"title":"Deferred Methods‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#deferred-methods","content":" Method\tDescriptiondeferSpawn(callback?)\tQueue entity creation deferDestroy(entityId)\tQueue entity destruction deferAdd(entityId, componentId)\tQueue adding a tag deferSet(entityId, componentId, value)\tQueue setting a component deferRemove(entityId, componentId)\tQueue removing a component flush()\tExecute all queued operations  ","version":"Next","tagName":"h2"},{"title":"Examples‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#examples","content":" ","version":"Next","tagName":"h2"},{"title":"Deferred Spawn‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#deferred-spawn","content":" -- Spawn with callback to configure the new entity world:deferSpawn(function(entityId) world:deferSet(entityId, Position, Vector3.zero) world:deferSet(entityId, Health, 100) world:deferAdd(entityId, Enemy) end) world:flush()   ","version":"Next","tagName":"h3"},{"title":"Deferred Destroy‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#deferred-destroy","content":" for entityId, health in world:query(Health) do if health &lt;= 0 then world:deferDestroy(entityId) end end world:flush()   ","version":"Next","tagName":"h3"},{"title":"Deferred Component Changes‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#deferred-component-changes","content":" for entityId, pos, vel in world:query(Position, Velocity) do -- Queue position update world:deferSet(entityId, Position, pos + vel * deltaTime) -- Queue removing velocity if stopped if vel.Magnitude &lt; 0.1 then world:deferRemove(entityId, Velocity) end end world:flush()   ","version":"Next","tagName":"h3"},{"title":"Chaining‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#chaining","content":" Deferred methods return the world for chaining:  world :deferSpawn(function(e) world:deferSet(e, Position, Vector3.zero) end) :deferDestroy(oldEntity) :deferSet(player, Health, 100) world:flush()   ","version":"Next","tagName":"h2"},{"title":"Checking Pending Commands‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#checking-pending-commands","content":" if world:hasPendingCommands() then world:flush() end   ","version":"Next","tagName":"h2"},{"title":"Deferred Mode‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#deferred-mode","content":" Enable deferred mode to use regular methods that auto-queue:  world:defer() -- Enable deferred mode -- These are now automatically queued world:set(entity, Health, 50) world:add(entity, Poisoned) world:flush() -- Execute and disable deferred mode   ","version":"Next","tagName":"h2"},{"title":"Automatic Flushing‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#automatic-flushing","content":" world:step() automatically flushes pending commands:  RunService.Heartbeat:Connect(function(dt) -- Systems can use deferred operations freely world:step(dt) -- Flushes at the start end)   ","version":"Next","tagName":"h2"},{"title":"Practical Example‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#practical-example","content":" A damage system that safely handles death:  local Health = world:component() local Damage = world:component() local Dead = world:tag() world:addSystem(&quot;ApplyDamage&quot;, &quot;Update&quot;, { reads = { Damage, Health }, writes = { Health, Dead } }, function(dt) -- Process damage for entityId, damage, health in world:query(Damage, Health) do local newHealth = health - damage world:deferSet(entityId, Health, newHealth) world:deferRemove(entityId, Damage) if newHealth &lt;= 0 then world:deferAdd(entityId, Dead) end end -- Note: flush happens automatically in step() end) world:addSystem(&quot;Cleanup&quot;, &quot;PostUpdate&quot;, { reads = { Dead } }, function(dt) for entityId in world:query(Dead) do world:deferDestroy(entityId) end end)   ","version":"Next","tagName":"h2"},{"title":"Best Practices‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#best-practices","content":" ","version":"Next","tagName":"h2"},{"title":"1. Prefer Deferred During Iteration‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#1-prefer-deferred-during-iteration","content":" -- ‚úÖ Good for entityId, health in world:query(Health) do if health &lt;= 0 then world:deferDestroy(entityId) end end -- ‚ùå Risky for entityId, health in world:query(Health) do if health &lt;= 0 then world:destroy(entityId) end end   ","version":"Next","tagName":"h3"},{"title":"2. Batch Related Operations‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#2-batch-related-operations","content":" -- ‚úÖ Good - one flush for multiple operations for entityId in world:query(Enemy) do world:deferSet(entityId, Health, 100) world:deferRemove(entityId, Damaged) end world:flush() -- ‚ùå Inefficient - flush after each for entityId in world:query(Enemy) do world:deferSet(entityId, Health, 100) world:flush() -- Don't do this! end   ","version":"Next","tagName":"h3"},{"title":"3. Let step() Handle Flushing‚Äã","type":1,"pageTitle":"Deferred Operations","url":"/AlloyECS/docs/guides/deferred-operations#3-let-step-handle-flushing","content":" -- ‚úÖ Good - step handles it world:addSystem(&quot;MySystem&quot;, &quot;Update&quot;, {}, function(dt) world:deferSet(entity, Health, 100) -- No need to flush - step() does it end) -- Works because step() flushes automatically RunService.Heartbeat:Connect(function(dt) world:step(dt) end)  ","version":"Next","tagName":"h3"},{"title":"World","type":0,"sectionRef":"#","url":"/AlloyECS/api/World","content":"","keywords":"","version":null},{"title":"Functions‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#functions","content":" ","version":null,"tagName":"h2"},{"title":"entity‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#entity","content":"Entity &lt;/&gt; World:entity() ‚Üí¬†number-- The new entity ID Creates a new entity and returns its ID. Entity IDs are recycled with incremented generations when entities are destroyed. Entity IDs Entity IDs encode both an index (24 bits) and a generation (8 bits). Use AlloyECS.decodeEntityIndex and AlloyECS.decodeEntityGeneration to extract these values. local entity = world:entity() world:set(entity, Position, Vector3.zero)   ","version":null,"tagName":"h3"},{"title":"isAlive‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#isAlive","content":"Entity &lt;/&gt; World:isAlive( entityId:¬†number-- The entity ID to check ) ‚Üí¬†boolean-- True if the entity exists and is alive Checks if an entity is currently alive in the world. Stale Entity IDs Always check isAlive before using a stored entity ID, as the entity may have been destroyed and its ID recycled. if world:isAlive(entity) then -- Safe to use entity local pos = world:get(entity, Position) end   ","version":null,"tagName":"h3"},{"title":"destroy‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#destroy","content":"Entity &lt;/&gt; World:destroy( entityId:¬†number-- The entity ID to destroy ) ‚Üí¬†() Destroys an entity, removing all its components and relationships. The entity's index will be recycled with an incremented generation. This will trigger World:onRemove hooks for all components on the entity. world:destroy(entity)   ","version":null,"tagName":"h3"},{"title":"getEntityCount‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#getEntityCount","content":"Entity &lt;/&gt; World:getEntityCount() ‚Üí¬†number-- The number of living entities Returns the total number of living entities in the world. print(&quot;Entities:&quot;, world:getEntityCount())   ","version":null,"tagName":"h3"},{"title":"getEntities‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#getEntities","content":"Entity &lt;/&gt; World:getEntities() ‚Üí¬†{number}-- Array of all living entity IDs Returns an array containing all living entity IDs. Performance For iteration, consider using World:each or World:query instead, as they don't create a new array. for _, entityId in world:getEntities() do print(entityId) end   ","version":null,"tagName":"h3"},{"title":"component‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#component","content":"Component &lt;/&gt; World:component( config:¬†{storage:¬†&quot;sparse&quot;¬†|¬†&quot;dense&quot;¬†|¬†&quot;tag&quot;}?-- Optional configuration ) ‚Üí¬†number-- The component ID Creates a new component type and returns its ID. Storage Type Description Use Case &quot;sparse&quot; Standard component with data (default) Most components &quot;dense&quot; (Coming soon) Optimized for components on most entities Components on 50%+ entities &quot;tag&quot; No data, just marks entities Flags like Player, Enemy Tags For tag components (no data), use World:tag as a shorthand. local Position = world:component() local Health = world:component({ storage = &quot;sparse&quot; }) local Visible = world:component({ storage = &quot;tag&quot; })   ","version":null,"tagName":"h3"},{"title":"tag‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#tag","content":"Component &lt;/&gt; World:tag() ‚Üí¬†number-- The tag component ID Creates a new tag component (a component with no data). Tags are useful for marking entities without storing any values. This is equivalent to world:component({ storage = &quot;tag&quot; }). local Player = world:tag() local Enemy = world:tag() world:add(entity, Player) -- Tags work in queries but return nil for their value for entityId in world:query(Player) do print(&quot;Found player:&quot;, entityId) end   ","version":null,"tagName":"h3"},{"title":"isTag‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#isTag","content":"Component &lt;/&gt; World:isTag( componentId:¬†number-- The component ID to check ) ‚Üí¬†boolean-- True if the component is a tag Checks if a component is a tag (has no data). if world:isTag(componentId) then world:add(entity, componentId) else world:set(entity, componentId, defaultValue) end   ","version":null,"tagName":"h3"},{"title":"add‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#add","content":"Component &lt;/&gt; World:add( entityId:¬†number,-- The entity to add the component to componentId:¬†number-- The component/tag to add ) ‚Üí¬†() Adds a tag or component (with value true) to an entity. Use World:set instead if you need to store a specific value. Triggers World:onAdd hooks. world:add(entity, Player) world:add(entity, Visible)   ","version":null,"tagName":"h3"},{"title":"set‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#set","content":"Component &lt;/&gt; World:set( entityId:¬†number,-- The entity to set the component on componentId:¬†number,-- The component ID value:¬†any-- The value to store ) ‚Üí¬†() Sets a component value on an entity. If the entity doesn't have the component, it will be added. Triggers World:onAdd hook if the component is new Triggers World:onChange hook if updating an existing value world:set(entity, Position, Vector3.new(0, 10, 0)) world:set(entity, Health, 100)   ","version":null,"tagName":"h3"},{"title":"get‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#get","content":"Component &lt;/&gt; World:get( entityId:¬†number,-- The entity to get the component from componentId:¬†number-- The component ID ) ‚Üí¬†any-- The component value, or nil if not present Gets a component value from an entity. Returns nil for tags or missing components. Tags For tags, use World:has to check presence since get returns nil. local pos = world:get(entity, Position) if pos then print(pos.X, pos.Y, pos.Z) end   ","version":null,"tagName":"h3"},{"title":"has‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#has","content":"Component &lt;/&gt; World:has( entityId:¬†number,-- The entity to check ...:¬†number-- One or more component IDs ) ‚Üí¬†boolean-- True if the entity has all specified components Checks if an entity has one or more components (including tags). -- Check single component if world:has(entity, Position) then -- ... end -- Check multiple components if world:has(entity, Position, Velocity) then -- Entity has both Position and Velocity end -- Works with tags too if world:has(entity, Player) then -- Entity is a player end   ","version":null,"tagName":"h3"},{"title":"remove‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#remove","content":"Component &lt;/&gt; World:remove( entityId:¬†number,-- The entity to remove the component from componentId:¬†number-- The component ID to remove ) ‚Üí¬†() Removes a component from an entity. Triggers World:onRemove hook with the old value. world:remove(entity, Velocity)   ","version":null,"tagName":"h3"},{"title":"query‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#query","content":"Query &lt;/&gt; World:query( ...:¬†number-- Component IDs to query for ) ‚Üí¬†QueryBuilder-- A query object that can be iterated directly or filtered with :with() / :without() Queries for entities that have all specified components. Returns a query object that yields the entity ID followed by component values. -- Simple query (direct iteration) for entityId, position in world:query(Position) do print(entityId, position) end -- Multiple components for entityId, pos, vel in world:query(Position, Velocity) do world:set(entityId, Position, pos + vel * deltaTime) end -- With filters (call :iter() after filters) for entityId, pos in world:query(Position):with(Player):without(Dead):iter() do -- Only living players with Position end Query Caching Queries are cached for performance. The cache is automatically invalidated when entities or components change. Filter Methods The query result supports chainable filter methods: :with(...) - Require components without returning their values :without(...) - Exclude entities with these components :iter() - Execute the filtered query (required when using filters)  ","version":null,"tagName":"h3"},{"title":"queryBuilder‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#queryBuilder","content":"Query Advanced &lt;/&gt; World:queryBuilder( ...:¬†number-- Component IDs to query for (values will be returned) ) ‚Üí¬†QueryBuilder-- A query builder for adding filters Creates a query builder for more complex queries with filters. Use query() Instead World:query now supports the same :with() and :without() modifiers. This method is provided for backwards compatibility. -- Preferred: use query() directly for entityId, pos in world:query(Position):with(Player):without(Dead):iter() do -- pos is returned, Player is required but not returned end -- Also works: explicit queryBuilder for entityId, pos in world:queryBuilder(Position):with(Player):without(Dead):iter() do -- Same result end   ","version":null,"tagName":"h3"},{"title":"added‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#added","content":"Reactive &lt;/&gt; World:added( componentId:¬†number-- The component ID to check ) ‚Üí¬†{number}-- Array of entity IDs that had this component added Returns entities that had the specified component added this frame. Requires Change Tracking This method requires trackChanges = true in AlloyECS.createWorld config. for _, entityId in world:added(Position) do print(&quot;Entity gained Position:&quot;, entityId) end   ","version":null,"tagName":"h3"},{"title":"removed‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#removed","content":"Reactive &lt;/&gt; World:removed( componentId:¬†number-- The component ID to check ) ‚Üí¬†{number}-- Array of entity IDs that had this component removed Returns entities that had the specified component removed this frame. Requires Change Tracking This method requires trackChanges = true in AlloyECS.createWorld config. for _, entityId in world:removed(Health) do print(&quot;Entity lost Health:&quot;, entityId) end   ","version":null,"tagName":"h3"},{"title":"changed‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#changed","content":"Reactive &lt;/&gt; World:changed( componentId:¬†number-- The component ID to check ) ‚Üí¬†{number}-- Array of entity IDs that had this component changed Returns entities that had the specified component value changed this frame. Requires Change Tracking This method requires trackChanges = true in AlloyECS.createWorld config. for _, entityId in world:changed(Position) do print(&quot;Entity moved:&quot;, entityId) end   ","version":null,"tagName":"h3"},{"title":"clearChanges‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#clearChanges","content":"Reactive &lt;/&gt; World:clearChanges() ‚Üí¬†() Clears all tracked changes for the current frame. Call this at the end of each frame after processing changes. Automatic Clearing World:step calls this automatically. Only call manually if you're not using step(). -- Process changes for _, entityId in world:added(Position) do -- Handle new positions end -- Clear for next frame world:clearChanges()   ","version":null,"tagName":"h3"},{"title":"defer‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#defer","content":"Deferred &lt;/&gt; World:defer() ‚Üí¬†() Enables deferred mode. In deferred mode, use the defer* methods to queue operations that will be executed when World:flush is called. Use Case Deferred operations are useful during iteration when you can't safely modify entities being queried.  ","version":null,"tagName":"h3"},{"title":"deferSpawn‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#deferSpawn","content":"Deferred &lt;/&gt; World:deferSpawn( callback:¬†((entityId:¬†number)¬†‚Üí¬†())?-- Optional callback with the new entity ID ) ‚Üí¬†World-- Returns self for chaining Queues an entity spawn operation. The callback receives the entity ID when flushed. world:deferSpawn(function(entityId) world:deferSet(entityId, Position, Vector3.zero) end)   ","version":null,"tagName":"h3"},{"title":"deferDestroy‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#deferDestroy","content":"Deferred &lt;/&gt; World:deferDestroy( entityId:¬†number-- The entity to destroy ) ‚Üí¬†World-- Returns self for chaining Queues an entity destroy operation. for entityId, health in world:query(Health) do if health &lt;= 0 then world:deferDestroy(entityId) end end world:flush()   ","version":null,"tagName":"h3"},{"title":"deferAdd‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#deferAdd","content":"Deferred &lt;/&gt; World:deferAdd( entityId:¬†number,-- The entity to add the component to componentId:¬†number-- The component to add ) ‚Üí¬†World-- Returns self for chaining Queues a component add operation. world:deferAdd(entity, Player)   ","version":null,"tagName":"h3"},{"title":"deferSet‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#deferSet","content":"Deferred &lt;/&gt; World:deferSet( entityId:¬†number,-- The entity to set the component on componentId:¬†number,-- The component ID value:¬†any-- The value to set ) ‚Üí¬†World-- Returns self for chaining Queues a component set operation. world:deferSet(entity, Position, newPosition)   ","version":null,"tagName":"h3"},{"title":"deferRemove‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#deferRemove","content":"Deferred &lt;/&gt; World:deferRemove( entityId:¬†number,-- The entity to remove the component from componentId:¬†number-- The component to remove ) ‚Üí¬†World-- Returns self for chaining Queues a component remove operation. world:deferRemove(entity, Velocity)   ","version":null,"tagName":"h3"},{"title":"flush‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#flush","content":"Deferred &lt;/&gt; World:flush() ‚Üí¬†() Executes all queued deferred operations and exits deferred mode. Automatic Flushing World:step calls flush automatically. Only call manually if you're not using step(). world:defer() world:deferSpawn() world:deferSet(entity, Position, pos) world:flush() -- All operations execute here   ","version":null,"tagName":"h3"},{"title":"hasPendingCommands‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#hasPendingCommands","content":"Deferred &lt;/&gt; World:hasPendingCommands() ‚Üí¬†boolean-- True if there are pending deferred commands Checks if there are any pending deferred commands to execute. if world:hasPendingCommands() then world:flush() end   ","version":null,"tagName":"h3"},{"title":"addSystem‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#addSystem","content":"System &lt;/&gt; World:addSystem( name:¬†string,-- Unique name for the system phase:¬†&quot;PreUpdate&quot;¬†|¬†&quot;Update&quot;¬†|¬†&quot;PostUpdate&quot;¬†|¬†&quot;PreRender&quot;¬†|¬†&quot;Render&quot;,-- Execution phase dependencies:¬†{ reads:¬†{number}?, writes:¬†{number}? },-- Component dependencies callback:¬†(deltaTime:¬†number)¬†‚Üí¬†()-- System function ) ‚Üí¬†System-- The created system Adds a system to the scheduler. Systems are batched by phase and can run in parallel if they don't have conflicting dependencies. Phase Description &quot;PreUpdate&quot; Before main update logic &quot;Update&quot; Main game logic &quot;PostUpdate&quot; After main update logic &quot;PreRender&quot; Before rendering &quot;Render&quot; Rendering logic world:addSystem(&quot;Movement&quot;, &quot;Update&quot;, { reads = { Position, Velocity }, writes = { Position } }, function(dt) for entityId, pos, vel in world:query(Position, Velocity) do world:set(entityId, Position, pos + vel * dt) end end)   ","version":null,"tagName":"h3"},{"title":"removeSystem‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#removeSystem","content":"System &lt;/&gt; World:removeSystem( name:¬†string-- The name of the system to remove ) ‚Üí¬†boolean-- True if the system was found and removed Removes a system from the scheduler. world:removeSystem(&quot;Movement&quot;)   ","version":null,"tagName":"h3"},{"title":"enableSystem‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#enableSystem","content":"System &lt;/&gt; World:enableSystem( name:¬†string-- The name of the system to enable ) ‚Üí¬†boolean-- True if the system was found and enabled Enables a previously disabled system. world:enableSystem(&quot;AI&quot;)   ","version":null,"tagName":"h3"},{"title":"disableSystem‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#disableSystem","content":"System &lt;/&gt; World:disableSystem( name:¬†string-- The name of the system to disable ) ‚Üí¬†boolean-- True if the system was found and disabled Disables a system without removing it. Disabled systems won't run. Use Case Useful for pausing specific systems, e.g., disabling AI during cutscenes. world:disableSystem(&quot;AI&quot;)   ","version":null,"tagName":"h3"},{"title":"runSystems‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#runSystems","content":"System &lt;/&gt; World:runSystems( deltaTime:¬†number-- Time since last frame ) ‚Üí¬†() Runs all enabled systems in all phases. Use step() Instead World:step handles flushing, running systems, and clearing changes. Use this only if you need manual control.  ","version":null,"tagName":"h3"},{"title":"runPhase‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#runPhase","content":"System &lt;/&gt; World:runPhase( phase:¬†&quot;PreUpdate&quot;¬†|¬†&quot;Update&quot;¬†|¬†&quot;PostUpdate&quot;¬†|¬†&quot;PreRender&quot;¬†|¬†&quot;Render&quot;,-- The phase to run deltaTime:¬†number-- Time since last frame ) ‚Üí¬†() Runs all enabled systems in a specific phase only. -- Run only render systems world:runPhase(&quot;Render&quot;, dt)   ","version":null,"tagName":"h3"},{"title":"step‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#step","content":"System &lt;/&gt; World:step( deltaTime:¬†number-- Time since last frame ) ‚Üí¬†() Performs a complete world update step: Flushes any pending deferred commands (World:flush) Runs all systems (World:runSystems) Clears change tracking (World:clearChanges) RunService.Heartbeat:Connect(function(dt) world:step(dt) end)   ","version":null,"tagName":"h3"},{"title":"relate‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#relate","content":"Relationship &lt;/&gt; World:relate( source:¬†number,-- The source entity relation:¬†number,-- The relation type (a component ID) target:¬†number,-- The target entity value:¬†any?-- Optional data to store with the relationship ) ‚Üí¬†() Creates a relationship between two entities. Relationships can optionally store data. Relation Types Use World:component to create relation types. They work like components but connect two entities together. local ChildOf = world:component() local Likes = world:component() -- Simple relationship world:relate(child, ChildOf, parent) -- Relationship with data world:relate(player, Likes, item, { amount = 10 }) -- Get all children for _, child in world:getSources(ChildOf, parent) do print(&quot;Child:&quot;, child) end   ","version":null,"tagName":"h3"},{"title":"unrelate‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#unrelate","content":"Relationship &lt;/&gt; World:unrelate( source:¬†number,-- The source entity relation:¬†number,-- The relation type target:¬†number-- The target entity ) ‚Üí¬†() Removes a relationship between two entities. world:unrelate(child, ChildOf, parent)   ","version":null,"tagName":"h3"},{"title":"getRelation‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#getRelation","content":"Relationship &lt;/&gt; World:getRelation( source:¬†number,-- The source entity relation:¬†number,-- The relation type target:¬†number-- The target entity ) ‚Üí¬†any-- The relationship data, or nil Gets the data stored in a relationship, if any. local likeData = world:getRelation(player, Likes, item) if likeData then print(&quot;Like amount:&quot;, likeData.amount) end   ","version":null,"tagName":"h3"},{"title":"hasRelation‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#hasRelation","content":"Relationship &lt;/&gt; World:hasRelation( source:¬†number,-- The source entity relation:¬†number,-- The relation type target:¬†number-- The target entity ) ‚Üí¬†boolean-- True if the relationship exists Checks if a relationship exists between two entities. if world:hasRelation(child, ChildOf, parent) then print(&quot;Is a child of parent&quot;) end   ","version":null,"tagName":"h3"},{"title":"getTargets‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#getTargets","content":"Relationship &lt;/&gt; World:getTargets( source:¬†number,-- The source entity relation:¬†number-- The relation type ) ‚Üí¬†{number}-- Array of target entity IDs Gets all target entities that the source has a relationship with. -- Get all items this player likes local likedItems = world:getTargets(player, Likes) for _, item in likedItems do print(&quot;Likes:&quot;, item) end   ","version":null,"tagName":"h3"},{"title":"getSources‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#getSources","content":"Relationship &lt;/&gt; World:getSources( relation:¬†number,-- The relation type target:¬†number-- The target entity ) ‚Üí¬†{number}-- Array of source entity IDs Gets all source entities that have a relationship to the target. -- Get all children of this parent local children = world:getSources(ChildOf, parent) for _, child in children do print(&quot;Child:&quot;, child) end   ","version":null,"tagName":"h3"},{"title":"prefab‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#prefab","content":"Prefab &lt;/&gt; World:prefab( name:¬†string?-- Optional name to retrieve a registered prefab ) ‚Üí¬†PrefabBuilder¬†|¬†PrefabData-- A builder or existing prefab data Creates a new prefab builder or retrieves an existing prefab by name. Prefabs are templates for spawning entities with predefined components. Builder Pattern The prefab builder uses a fluent interface: :with(componentId, value?) - Add a component or tag :build(name?) - Build the prefab, optionally registering by name -- Create and register a prefab local enemyPrefab = world:prefab() :with(Health, 100) :with(Position, Vector3.zero) :with(Enemy) :build(&quot;Enemy&quot;) -- Spawn from the prefab local enemy = world:spawn(&quot;Enemy&quot;) -- Retrieve existing prefab by name local existingPrefab = world:prefab(&quot;Enemy&quot;)   ","version":null,"tagName":"h3"},{"title":"spawn‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#spawn","content":"Prefab &lt;/&gt; World:spawn( prefabOrName:¬†PrefabData¬†|¬†string-- A prefab object or registered name ) ‚Üí¬†number-- The spawned entity ID Spawns a new entity from a prefab template. This will trigger World:onAdd hooks for all components in the prefab. -- Spawn from registered name local enemy = world:spawn(&quot;Enemy&quot;) -- Spawn from prefab object local enemy2 = world:spawn(enemyPrefab) -- Customize after spawning world:set(enemy, Position, Vector3.new(10, 0, 0))   ","version":null,"tagName":"h3"},{"title":"onAdd‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#onAdd","content":"Event &lt;/&gt; World:onAdd( componentId:¬†number,-- The component to watch callback:¬†( entityId:¬†number, value:¬†any )¬†‚Üí¬†()-- Called when component is added ) ‚Üí¬†()¬†‚Üí¬†()-- Unsubscribe function Registers a callback that fires when a component is added to any entity. Returns a function to unsubscribe. When It Fires Fires on World:add, World:set (for new components), and World:spawn. local unsubscribe = world:onAdd(Position, function(entityId, value) print(&quot;Entity&quot;, entityId, &quot;gained Position:&quot;, value) end) -- Later, to stop listening: unsubscribe()   ","version":null,"tagName":"h3"},{"title":"onRemove‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#onRemove","content":"Event &lt;/&gt; World:onRemove( componentId:¬†number,-- The component to watch callback:¬†( entityId:¬†number, value:¬†any )¬†‚Üí¬†()-- Called when component is removed ) ‚Üí¬†()¬†‚Üí¬†()-- Unsubscribe function Registers a callback that fires when a component is removed from any entity. The callback receives the old value before removal. When It Fires Fires on World:remove and World:destroy (for all components). world:onRemove(Health, function(entityId, oldValue) if oldValue &lt;= 0 then print(&quot;Entity&quot;, entityId, &quot;died!&quot;) end end)   ","version":null,"tagName":"h3"},{"title":"onChange‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#onChange","content":"Event &lt;/&gt; World:onChange( componentId:¬†number,-- The component to watch callback:¬†( entityId:¬†number, oldValue:¬†any, newValue:¬†any )¬†‚Üí¬†()-- Called when component changes ) ‚Üí¬†()¬†‚Üí¬†()-- Unsubscribe function Registers a callback that fires when a component value is changed. Only fires for components that already exist (not on initial add). When It Fires Fires on World:set when updating an existing component value. world:onChange(Health, function(entityId, oldHealth, newHealth) if newHealth &lt; oldHealth then print(&quot;Entity&quot;, entityId, &quot;took&quot;, oldHealth - newHealth, &quot;damage!&quot;) end end)   ","version":null,"tagName":"h3"},{"title":"serialize‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#serialize","content":"Persistence &lt;/&gt; World:serialize( typeHandlers:¬†{[string]:¬†(any)¬†‚Üí¬†any}?-- Optional handlers for custom types ) ‚Üí¬†SerializedWorld-- The serialized world state Serializes the entire world state to a table that can be saved. Use typeHandlers to convert non-serializable types like Vector3. Custom Types Roblox types like Vector3, CFrame, etc. must be converted using typeHandlers or they won't serialize properly. local data = world:serialize({ Vector3 = function(v) return { x = v.X, y = v.Y, z = v.Z } end, }) -- Save data to DataStore, file, etc.   ","version":null,"tagName":"h3"},{"title":"deserialize‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#deserialize","content":"Persistence &lt;/&gt; World:deserialize( data:¬†SerializedWorld,-- The serialized world state typeHandlers:¬†{[string]:¬†(any)¬†‚Üí¬†any}?-- Optional handlers to reconstruct custom types ) ‚Üí¬†() Restores world state from serialized data. Clears Existing Data This clears all existing entities, components, and relationships before loading the serialized data. world:deserialize(savedData, { Vector3 = function(v) if v.x then return Vector3.new(v.x, v.y, v.z) end return nil end, })   ","version":null,"tagName":"h3"},{"title":"each‚Äã","type":1,"pageTitle":"World","url":"/AlloyECS/api/World#each","content":"Entity &lt;/&gt; World:each( callback:¬†(entityId:¬†number)¬†‚Üí¬†()-- Function to call for each entity ) ‚Üí¬†() Iterates over all living entities in the world. Alternative For filtering entities by component, use World:query instead. world:each(function(entityId) print(&quot;Entity:&quot;, entityId) end)  ","version":null,"tagName":"h3"}],"options":{"id":"default"}}